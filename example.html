<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>codecopy</title>
    <link href="copycode.css" rel="stylesheet" />
    <script src="copycode.js"></script>
    <style>
      body {
        width: 960px;
        margin: 50px auto;
      }
      pre:has(code) {
        position: relative;
        padding: 20px;
        margin-bottom: 20px;
      }

      pre code {
        display: inline-block;
        width: 100%;
        overflow-x: auto;
      }
    </style>
  </head>
  <body>
    <pre
      tabindex="0"
      style="
        color: #ebdbb2;
        background-color: #282828;
        -moz-tab-size: 4;
        -o-tab-size: 4;
        tab-size: 4;
      "
    ><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#fe8019">const</span> copyCode <span style="color:#fe8019">=</span> <span style="color:#fe8019">async</span> (el) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#fe8019">let</span> code <span style="color:#fe8019">=</span> el.querySelector(<span style="color:#b8bb26">"code"</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#fe8019">let</span> text <span style="color:#fe8019">=</span> cleanCopy(code.innerText);
</span></span><span style="display:flex;"><span>  <span style="color:#fe8019">await</span> navigator.clipboard.writeText(text);
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fe8019">const</span> cleanCopy <span style="color:#fe8019">=</span> (str) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#fe8019">const</span> lines <span style="color:#fe8019">=</span> str.split(<span style="color:#b8bb26">"\n"</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#fe8019">let</span> result <span style="color:#fe8019">=</span> [];
</span></span><span style="display:flex;"><span>  <span style="color:#fe8019">for</span> (<span style="color:#fe8019">let</span> i <span style="color:#fe8019">=</span> <span style="color:#d3869b">0</span>; i <span style="color:#fe8019">&lt;</span> lines.length; i<span style="color:#fe8019">++</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#fe8019">if</span> (lines[i].trim() <span style="color:#fe8019">!==</span> <span style="color:#b8bb26">""</span>) {
</span></span><span style="display:flex;"><span>      result.push(lines[i]);
</span></span><span style="display:flex;"><span>    } <span style="color:#fe8019">else</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#fe8019">if</span> (i <span style="color:#fe8019">+</span> <span style="color:#d3869b">1</span> <span style="color:#fe8019">&lt;</span> lines.length <span style="color:#fe8019">&amp;&amp;</span> lines[i <span style="color:#fe8019">+</span> <span style="color:#d3869b">1</span>].trim() <span style="color:#fe8019">===</span> <span style="color:#b8bb26">""</span>) {
</span></span><span style="display:flex;"><span>        result.push(<span style="color:#b8bb26">""</span>);
</span></span><span style="display:flex;"><span>        i<span style="color:#fe8019">++</span>;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#fe8019">return</span> result.join(<span style="color:#b8bb26">"\n"</span>);
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fe8019">const</span> SVG2HTMLElement <span style="color:#fe8019">=</span> (svgString) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#fe8019">const</span> parser <span style="color:#fe8019">=</span> <span style="color:#fe8019">new</span> DOMParser();
</span></span><span style="display:flex;"><span>  <span style="color:#fe8019">const</span> doc <span style="color:#fe8019">=</span> parser.parseFromString(svgString, <span style="color:#b8bb26">"image/svg+xml"</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#fe8019">const</span> svgElement <span style="color:#fe8019">=</span> doc.documentElement;
</span></span><span style="display:flex;"><span>  <span style="color:#fe8019">return</span> svgElement;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fe8019">const</span> copy_svg <span style="color:#fe8019">=</span> <span style="color:#b8bb26">`&lt;svg xmlns="http://www.w3.org/2000/svg" width="18px" height="18px" viewBox="0 0 24 24"&gt;&lt;path fill="currentColor" fill-rule="evenodd" d="M3 3a1 1 0 0 1 1-1h12a1 1 0 1 1 0 2H5v12a1 1 0 1 1-2 0zm4 4a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v12a3 3 0 0 1-3 3h-8a3 3 0 0 1-3-3z" clip-rule="evenodd"/&gt;&lt;/svg&gt;`</span>;
</span></span><span style="display:flex;"><span><span style="color:#fe8019">const</span> copied_svg <span style="color:#fe8019">=</span> <span style="color:#b8bb26">`&lt;svg xmlns="http://www.w3.org/2000/svg" width="18px" height="18px" viewBox="0 0 24 24"&gt;&lt;path fill="currentColor" d="M18.333 6A3.667 3.667 0 0 1 22 9.667v8.666A3.667 3.667 0 0 1 18.333 22H9.667A3.667 3.667 0 0 1 6 18.333V9.667A3.667 3.667 0 0 1 9.667 6zM15 2c1.094 0 1.828.533 2.374 1.514a1 1 0 1 1-1.748.972C15.405 4.088 15.284 4 15 4H5c-.548 0-1 .452-1 1v9.998c0 .32.154.618.407.805l.1.065a1 1 0 1 1-.99 1.738A3 3 0 0 1 2 15V5c0-1.652 1.348-3 3-3zm1.293 9.293L13 14.585l-1.293-1.292a1 1 0 0 0-1.414 1.414l2 2a1 1 0 0 0 1.414 0l4-4a1 1 0 0 0-1.414-1.414"/&gt;&lt;/svg&gt;`</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fe8019">let</span> copy_icon <span style="color:#fe8019">=</span> SVG2HTMLElement(copy_svg);
</span></span><span style="display:flex;"><span><span style="color:#fe8019">let</span> copied_icon <span style="color:#fe8019">=</span> SVG2HTMLElement(copied_svg);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fe8019">const</span> codeblocks <span style="color:#fe8019">=</span> <span style="color:#fabd2f">document</span>.querySelectorAll(<span style="color:#b8bb26">"pre:has(code)"</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>codeblocks.forEach((codeblock) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#fe8019">let</span> btn <span style="color:#fe8019">=</span> <span style="color:#fabd2f">document</span>.createElement(<span style="color:#b8bb26">"button"</span>);
</span></span><span style="display:flex;"><span>  btn.classList.add(<span style="color:#b8bb26">"codecopy"</span>);
</span></span><span style="display:flex;"><span>  btn.appendChild(copy_icon.cloneNode(<span style="color:#fe8019">true</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  codeblock.appendChild(btn);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  btn.addEventListener(<span style="color:#b8bb26">"click"</span>, <span style="color:#fe8019">async</span> () =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#fe8019">await</span> copyCode(codeblock);
</span></span><span style="display:flex;"><span>    btn.classList.add(<span style="color:#b8bb26">"copied"</span>);
</span></span><span style="display:flex;"><span>    btn.replaceChildren(copied_icon.cloneNode(<span style="color:#fe8019">true</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    setTimeout(() =&gt; {
</span></span><span style="display:flex;"><span>      btn.classList.remove(<span style="color:#b8bb26">"copied"</span>);
</span></span><span style="display:flex;"><span>      btn.replaceChildren(copy_icon.cloneNode(<span style="color:#fe8019">true</span>));
</span></span><span style="display:flex;"><span>    }, <span style="color:#d3869b">1500</span>);
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>});
</span></span></code></pre>
  </body>
</html>
